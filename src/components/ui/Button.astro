---
type Variant = "primary" | "secondary" | "whatsapp";
type Size = "sm" | "md" | "lg";
import { withBase } from "@/lib/urls";

interface Props {
  href?: string;
  target?: "_blank" | "_self" | "_parent" | "_top";
  rel?: string;
  type?: "button" | "submit" | "reset";
  variant?: Variant;
  size?: Size;
  class?: string;
  ariaLabel?: string;
  trackEvent?: "click_whatsapp" | "click_maps" | "click_call";
  trackSource?: "header" | "hero" | "location" | "footer";
}

const {
  href,
  target,
  rel,
  type = "button",
  variant = "primary",
  size = "md",
  class: className,
  ariaLabel,
  trackEvent,
  trackSource,
} = Astro.props;

const baseClass =
  "ui-button inline-flex min-h-11 items-center justify-center rounded-card font-sans font-semibold no-underline hover:no-underline transition-colors duration-150 active:translate-y-px focus-visible:ring-2 focus-visible:ring-offset-2";

const sizeClassByName: Record<Size, string> = {
  sm: "px-4 text-sm leading-[22px]",
  md: "px-5 text-sm leading-[22px]",
  lg: "px-6 text-base leading-[26px]",
};

const variantClassByName: Record<Variant, string> = {
  primary:
    "bg-primary !text-white hover:bg-primary-dark hover:!text-white active:bg-primary-darker active:!text-white focus-visible:ring-primary",
  secondary:
    "border border-border bg-surface text-primary hover:bg-muted-subtle active:bg-muted-subtle focus-visible:ring-primary",
  whatsapp:
    "bg-whatsapp !text-white hover:bg-whatsapp-dark hover:!text-white active:bg-whatsapp-darker active:!text-white focus-visible:ring-whatsapp",
};

const classes = `${baseClass} ${sizeClassByName[size]} ${variantClassByName[variant]} ${className ?? ""}`;
const resolvedHref = href ? withBase(href) : undefined;
---

{
  resolvedHref ? (
    <a
      href={resolvedHref}
      target={target}
      rel={rel}
      class={classes}
      aria-label={ariaLabel}
      data-track-event={trackEvent}
      data-track-source={trackSource}
    >
      <slot />
    </a>
  ) : (
    <button
      type={type}
      class={classes}
      aria-label={ariaLabel}
      data-track-event={trackEvent}
      data-track-source={trackSource}
    >
      <slot />
    </button>
  )
}
