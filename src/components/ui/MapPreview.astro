---
import Button from "@/components/ui/Button.astro";

interface Props {
  mapsUrl: string;
  staticMapUrl: string | null;
  alt: string;
  aspect?: string;
  titleBadge?: string;
  className?: string;
}

const {
  mapsUrl,
  staticMapUrl,
  alt,
  aspect = "4/3",
  titleBadge,
  className,
} = Astro.props;

const wrapperClass =
  `group relative overflow-hidden rounded-2xl border border-border bg-muted shadow-soft ${className ?? ""}`;
---

<div class={wrapperClass} style={`aspect-ratio: ${aspect};`}>
  {
    staticMapUrl ? (
      <>
        <img
          src={staticMapUrl}
          alt={alt}
          class="size-full object-cover"
          loading="lazy"
          decoding="async"
          sizes="(min-width: 1024px) 48vw, 100vw"
        />
        <div
          class="pointer-events-none absolute inset-0 bg-primary/10 opacity-0 transition-opacity duration-200 group-hover:opacity-100 group-focus-within:opacity-100"
          aria-hidden="true"
        />
        <div
          class="pointer-events-none absolute inset-0 flex items-center justify-center"
          aria-hidden="true"
        >
          <span class="inline-flex h-12 w-12 items-center justify-center rounded-full bg-surface/90 text-primary shadow-soft">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="h-6 w-6"
            >
              <path
                fill-rule="evenodd"
                d="M12 2.25a7.5 7.5 0 0 0-7.5 7.5c0 5.61 6.45 11.46 7.5 12.35 1.05-.89 7.5-6.74 7.5-12.35a7.5 7.5 0 0 0-7.5-7.5Zm0 10.5a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z"
                clip-rule="evenodd"
              />
            </svg>
          </span>
        </div>
      </>
    ) : (
      <div class="flex size-full flex-col items-center justify-center gap-4 px-6 text-center">
        <span class="inline-flex h-12 w-12 items-center justify-center rounded-full bg-surface text-primary shadow-soft">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="h-6 w-6"
            aria-hidden="true"
          >
            <path
              fill-rule="evenodd"
              d="M12 2.25a7.5 7.5 0 0 0-7.5 7.5c0 5.61 6.45 11.46 7.5 12.35 1.05-.89 7.5-6.74 7.5-12.35a7.5 7.5 0 0 0-7.5-7.5Zm0 10.5a3 3 0 1 1 0-6 3 3 0 0 1 0 6Z"
              clip-rule="evenodd"
            />
          </svg>
        </span>
        <p class="font-sans text-body text-text-muted">Ver ubicacion en Google Maps</p>
      </div>
    )
  }

  {
    titleBadge ? (
      <span class="absolute left-4 top-4 rounded-full border border-border bg-surface px-3 py-1 font-sans text-xs uppercase tracking-wider text-primary">
        {titleBadge}
      </span>
    ) : null
  }

  <div class="absolute inset-x-0 bottom-0 p-4 sm:p-5">
    <Button
      href={mapsUrl}
      variant="secondary"
      ariaLabel="Abrir ubicacion del consultorio en Google Maps"
      target="_blank"
      rel="noopener noreferrer"
      trackEvent="click_maps"
      trackSource="location"
    >
      Abrir en Google Maps
    </Button>
  </div>
</div>
